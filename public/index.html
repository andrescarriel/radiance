<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LÃœM Radiance | Dashboard</title>
  <script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- SIDEBAR -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <div class="logo">LÃœM</div>
      <div class="logo-sub">RADIANCE</div>
    </div>
    
    <nav class="sidebar-nav">
      <button type="button" class="nav-item active" data-module="overview">
        <span class="nav-icon">ðŸ“Š</span>
        <span class="nav-label">Overview</span>
      </button>
      <button type="button" class="nav-item" data-module="capture">
        <span class="nav-icon">ðŸŽ¯</span>
        <span class="nav-label">Commerce Capture</span>
      </button>
      <button type="button" class="nav-item" data-module="switching">
        <span class="nav-icon">ðŸ”„</span>
        <span class="nav-label">Switching</span>
      </button>
      <button type="button" class="nav-item" data-module="leakage">
        <span class="nav-icon">ðŸŒŠ</span>
        <span class="nav-label">Leakage</span>
      </button>
      <button type="button" class="nav-item" data-module="basket">
        <span class="nav-icon">ðŸ›’</span>
        <span class="nav-label">Basket</span>
      </button>
      <button type="button" class="nav-item" data-module="loyalty">
        <span class="nav-icon">ðŸ’Ž</span>
        <span class="nav-label">Loyalty</span>
      </button>
    </nav>
    
    <div class="sidebar-footer">
      <div class="version">v2.2.0</div>
    </div>
  </aside>

  <!-- MAIN CONTENT -->
  <main class="main">
    <!-- GLOBAL FILTERS -->
    <header class="filters-bar">
      <div class="filter-group">
  <label>Retailer</label>
  <select id="filterIssuerRuc">
    <option value="">Cargando...</option>
  </select>
</div>
      <div class="filter-group">
        <label>Desde</label>
        <input type="date" id="filterStart" value="2025-01-01">
      </div>
      <div class="filter-group">
        <label>Hasta</label>
        <input type="date" id="filterEnd" value="2025-07-01">
      </div>
      <div class="filter-group">
        <label>CategorÃ­a</label>
        <select id="filterCategoryLevel">
          <option value="l1">L1</option>
          <option value="l2">L2</option>
          <option value="l3">L3</option>
          <option value="l4">L4</option>
        </select>
      </div>
      <div class="filter-group">
        <label>Reconcile</label>
        <select id="filterReconcile">
          <option value="all">All</option>
          <option value="true">True</option>
          <option value="false">False</option>
        </select>
      </div>
      <div class="filter-group">
        <label>K-Threshold</label>
        <input type="number" id="filterKThreshold" value="5" min="1" max="100">
      </div>
      <button type="button" id="btnApplyFilters" class="btn-primary">Aplicar</button>
      <button type="button" id="btnResetFilters" class="btn-secondary">Reset</button>
      <button type="button" id="btnExportDeck" class="btn-secondary">Export Deck</button>
    </header>

    <!-- FILTER STATUS STRIP -->
    <div class="filter-status" id="filterStatus">
      <span class="status-chip"><span class="status-label">Panel:</span> Observed</span>
      <span class="status-chip"><span class="status-label">K-threshold:</span> <span id="statusKThreshold">5</span></span>
      <span class="status-chip"><span class="status-label">Reconcile:</span> <span id="statusReconcile">All</span></span>
    </div>

    <!-- GLOBAL BANNER -->
    <div id="globalBanner" class="global-banner hidden"></div>

    <!-- MODULE: OVERVIEW -->
    <section class="module" id="moduleOverview">
      <div class="module-header">
        <h1>Overview</h1>
        <p class="module-desc">KPIs principales y tendencias del perÃ­odo</p>
      </div>
      
      <!-- KPI Cards Row 1: Core -->
      <div class="kpi-grid kpi-grid-4">
        <div class="kpi-card hero">
          <div class="kpi-label">Ventas Totales</div>
          <div class="kpi-value" id="kpiVentas">â€”</div>
          <div class="kpi-delta" id="kpiVentasDelta"></div>
        </div>
        <div class="kpi-card">
  <div class="kpi-label">Meses Activos</div>
  <div class="kpi-value" id="kpiMeses">â€”</div>
</div>
        <div class="kpi-card">
          <div class="kpi-label">Clientes Ãšnicos</div>
          <div class="kpi-value" id="kpiClientes">â€”</div>
          <div class="kpi-delta" id="kpiClientesDelta"></div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">Ticket Promedio</div>
          <div class="kpi-value" id="kpiTicket">â€”</div>
          <div class="kpi-delta" id="kpiTicketDelta"></div>
        </div>
      </div>
      
      <!-- KPI Cards Row 2: Secondary -->
      <div class="kpi-grid kpi-grid-4">
        <div class="kpi-card">
          <div class="kpi-label">Frecuencia</div>
          <div class="kpi-value" id="kpiFrecuencia">â€”</div>
          <div class="kpi-sub">txn/cliente</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">Productos Ãšnicos</div>
          <div class="kpi-value" id="kpiProductos">â€”</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">CategorÃ­as</div>
          <div class="kpi-value" id="kpiCategorias">â€”</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">Share of Wallet</div>
          <div class="kpi-value" id="kpiSoW">â€”</div>
        </div>
      </div>

      <!-- Charts Row -->
      <div class="charts-row">
        <div class="chart-card">
          <div class="chart-header">
            <h3>Ventas por Mes</h3>
            <span class="chart-meta">USD Â· Observed Panel</span>
          </div>
          <div class="chart-body">
            <canvas id="chartVentasMes"></canvas>
          </div>
        </div>
        <div class="chart-card">
          <div class="chart-header">
            <h3>Clientes por Mes</h3>
            <span class="chart-meta">Usuarios Ãºnicos</span>
          </div>
          <div class="chart-body">
            <canvas id="chartClientesMes"></canvas>
          </div>
        </div>
      </div>

      <div class="charts-row">
        <div class="chart-card">
          <div class="chart-header">
            <h3>Transacciones por DÃ­a de Semana</h3>
            <span class="chart-meta">DistribuciÃ³n %</span>
          </div>
          <div class="chart-body">
            <canvas id="chartTxnDia"></canvas>
          </div>
        </div>
        <div class="chart-card">
          <div class="chart-header">
            <h3>Top 10 CategorÃ­as</h3>
            <span class="chart-meta">Por ventas USD</span>
          </div>
          <div class="chart-body">
            <canvas id="chartTopCategorias"></canvas>
          </div>
        </div>
      </div>
    </section>

    <!-- MODULE: CAPTURE -->
    <section class="module hidden" id="moduleCapture">
      <div class="module-header">
        <h1>Commerce Capture</h1>
        <p class="module-desc">Share of Wallet y Leakage por categorÃ­a</p>
      </div>
      
      <div class="kpi-grid kpi-grid-3">
        <div class="kpi-card hero">
          <div class="kpi-label">SoW Global</div>
          <div class="kpi-value" id="captureSoW">â€”</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">Spend in X</div>
          <div class="kpi-value" id="captureInX">â€”</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">Leakage</div>
          <div class="kpi-value" id="captureLeakage">â€”</div>
        </div>
      </div>

      <div class="charts-row">
        <div class="chart-card">
          <div class="chart-header">
            <h3>Share of Wallet por CategorÃ­a</h3>
            <span class="chart-meta">% del gasto capturado</span>
          </div>
          <div class="chart-body">
            <canvas id="chartCaptureSoW"></canvas>
          </div>
        </div>
        <div class="chart-card">
          <div class="chart-header">
            <h3>In-X vs Leakage por CategorÃ­a</h3>
            <span class="chart-meta">USD</span>
          </div>
          <div class="chart-body">
            <canvas id="chartCaptureStacked"></canvas>
          </div>
        </div>
      </div>

      <div class="table-card">
        <div class="table-header">
          <h3>Detalle por CategorÃ­a</h3>
        </div>
        <div class="table-body">
          <table id="tableCaptureDetail">
            <thead>
              <tr>
                <th>CategorÃ­a</th>
                <th class="text-right">Usuarios</th>
                <th class="text-right">Gasto X</th>
                <th class="text-right">Gasto Market</th>
                <th class="text-right">Leakage</th>
                <th class="text-right">SoW %</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- MODULE: SWITCHING -->
    <section class="module hidden" id="moduleSwitching">
      <div class="module-header">
        <h1>Switching Destinations</h1>
        <p class="module-desc">Â¿A dÃ³nde van los clientes cuando no compran en X?</p>
      </div>
      
      <div class="charts-row single">
        <div class="chart-card wide">
          <div class="chart-header">
            <h3>Top Destinos Competencia</h3>
            <span class="chart-meta">% del cohort</span>
          </div>
          <div class="chart-body">
            <canvas id="chartSwitching"></canvas>
          </div>
        </div>
      </div>

      <div class="table-card">
        <div class="table-header">
          <h3>Detalle de Destinos</h3>
        </div>
        <div class="table-body">
          <table id="tableSwitching">
            <thead>
              <tr>
                <th>Destino</th>
                <th class="text-right">Usuarios</th>
                <th class="text-right">% Cohort</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- MODULE: LEAKAGE -->
    <section class="module hidden" id="moduleLeakage">
      <div class="module-header">
        <h1>Leakage Waterfall</h1>
        <p class="module-desc">Â¿Por quÃ© los usuarios no recompran en X?</p>
      </div>

      <div class="filter-inline">
        <label>CategorÃ­a:</label>
        <select id="leakageCategorySelect">
          <option value="">Selecciona categorÃ­a...</option>
        </select>
      </div>
      
      <div class="charts-row single">
        <div class="chart-card wide">
          <div class="chart-header">
            <h3>Waterfall 6-Bucket</h3>
            <span class="chart-meta">% del cohort por bucket</span>
          </div>
          <div class="chart-body">
            <canvas id="chartLeakage"></canvas>
          </div>
        </div>
      </div>

      <div class="buckets-legend">
        <div class="bucket-item"><span class="bucket-color c-green"></span> RETAINED: Mantiene spend â‰¥90%</div>
        <div class="bucket-item"><span class="bucket-color c-yellow"></span> CATEGORY_GONE: DejÃ³ la categorÃ­a</div>
        <div class="bucket-item"><span class="bucket-color c-orange"></span> REDUCED_BASKET: Spend &lt;50%</div>
        <div class="bucket-item"><span class="bucket-color c-orange"></span> REDUCED_FREQ: Menos visitas</div>
        <div class="bucket-item"><span class="bucket-color c-red"></span> DELAYED_ONLY: Solo retraso</div>
        <div class="bucket-item"><span class="bucket-color c-gray"></span> FULL_CHURN: Sin actividad</div>
      </div>
    </section>

    <!-- MODULE: BASKET -->
    <section class="module hidden" id="moduleBasket">
      <div class="module-header">
        <h1>Basket Analysis</h1>
        <p class="module-desc">Breadth y composiciÃ³n del basket</p>
      </div>
      
      <div class="kpi-grid kpi-grid-2">
        <div class="kpi-card">
          <div class="kpi-label">Avg Breadth Market</div>
          <div class="kpi-value" id="basketBreadthMarket">â€”</div>
          <div class="kpi-sub"># categorÃ­as/mes</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">Avg Breadth In-X</div>
          <div class="kpi-value" id="basketBreadthInX">â€”</div>
          <div class="kpi-sub"># categorÃ­as/mes</div>
        </div>
      </div>

      <div class="charts-row single">
        <div class="chart-card wide">
          <div class="chart-header">
            <h3>Breadth: Market vs In-X por Mes</h3>
            <span class="chart-meta"># categorÃ­as promedio</span>
          </div>
          <div class="chart-body">
            <canvas id="chartBasket"></canvas>
          </div>
        </div>
      </div>
    </section>

    <!-- MODULE: LOYALTY -->
    <section class="module hidden" id="moduleLoyalty">
      <div class="module-header">
        <h1>Brand Loyalty</h1>
        <p class="module-desc">Lealtad a marcas dentro de categorÃ­as</p>
      </div>

      <div class="filter-inline">
        <label>CategorÃ­a:</label>
        <select id="loyaltyCategorySelect">
          <option value="">Selecciona categorÃ­a...</option>
        </select>
      </div>

      <div class="kpi-grid kpi-grid-4">
        <div class="kpi-card">
          <div class="kpi-label">Exclusive (â‰¥95%)</div>
          <div class="kpi-value" id="loyaltyExclusive">â€”</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">Loyal (â‰¥80%)</div>
          <div class="kpi-value" id="loyaltyLoyal">â€”</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">Prefer (â‰¥50%)</div>
          <div class="kpi-value" id="loyaltyPrefer">â€”</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">Light (&lt;50%)</div>
          <div class="kpi-value" id="loyaltyLight">â€”</div>
        </div>
      </div>

      <div class="charts-row">
        <div class="chart-card">
          <div class="chart-header">
            <h3>DistribuciÃ³n de Lealtad</h3>
            <span class="chart-meta">Usuarios por tier</span>
          </div>
          <div class="chart-body">
            <canvas id="chartLoyaltyTiers"></canvas>
          </div>
        </div>
        <div class="chart-card">
          <div class="chart-header">
            <h3>User Brand Share (Percentiles)</h3>
            <span class="chart-meta">% share p10-p90</span>
          </div>
          <div class="chart-body">
            <canvas id="chartLoyaltyDist"></canvas>
          </div>
        </div>
      </div>

      <div class="table-card">
        <div class="table-header">
          <h3>Top Marcas</h3>
        </div>
        <div class="table-body">
          <table id="tableLoyalty">
            <thead>
              <tr>
                <th>Marca</th>
                <th class="text-right">Buyers</th>
                <th class="text-right">PenetraciÃ³n</th>
                <th class="text-right">p75 Share</th>
                <th class="text-right">Loyalty Rate</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- LOADING OVERLAY -->
    <div class="loading-overlay hidden" id="loadingOverlay">
      <div class="spinner"></div>
      <div class="loading-text">Cargando datos...</div>
    </div>

    <!-- TOAST NOTIFICATIONS -->
    <div class="toast-container" id="toastContainer"></div>
  </main>

  <script src="app.js"></script>
</body>
</html>
